{"version":3,"file":"static/js/376.7bf5c019.chunk.js","mappings":"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","sources":["pages/CEO_Dashboard/lib/events.js","pages/CEO_Dashboard/CEODashboardComponents/Assessments.js","pages/CEO_Dashboard/services/orgHealth/index.js","pages/CEO_Dashboard/services/orgHealth/score.js"],"sourcesContent":["// Thin wrapper around CustomEvent to keep event names consistent and provide typed helpers\n\nexport const EVENT_NAMES = {\n  start: \"conseqx:assessment:start\",\n  progress: \"conseqx:assessment:progress\",\n  completed: \"conseqx:assessment:completed\",\n  view: \"conseqx:assessment:view\",\n};\n\nexport function emitAssessmentStart({ orgId, systemId }) {\n  try {\n    window.dispatchEvent(new CustomEvent(EVENT_NAMES.start, { detail: { orgId, systemId } }));\n  } catch {}\n}\n\nexport function emitAssessmentProgress({ orgId, systemId, progress, result }) {\n  try {\n    window.dispatchEvent(new CustomEvent(EVENT_NAMES.progress, { detail: { orgId, systemId, progress, result } }));\n  } catch {}\n}\n\nexport function emitAssessmentCompleted(resultObject) {\n  try {\n    window.dispatchEvent(new CustomEvent(EVENT_NAMES.completed, { detail: resultObject }));\n  } catch {}\n}\n\nexport function onAssessmentStart(cb) {\n  const handler = (e) => cb?.(e?.detail);\n  window.addEventListener(EVENT_NAMES.start, handler);\n  return () => window.removeEventListener(EVENT_NAMES.start, handler);\n}\n\nexport function onAssessmentProgress(cb) {\n  const handler = (e) => cb?.(e?.detail);\n  window.addEventListener(EVENT_NAMES.progress, handler);\n  return () => window.removeEventListener(EVENT_NAMES.progress, handler);\n}\n\nexport function onAssessmentCompleted(cb) {\n  const handler = (e) => cb?.(e?.detail);\n  window.addEventListener(EVENT_NAMES.completed, handler);\n  return () => window.removeEventListener(EVENT_NAMES.completed, handler);\n}\n\nexport default {\n  EVENT_NAMES,\n  emitAssessmentStart,\n  emitAssessmentProgress,\n  emitAssessmentCompleted,\n  onAssessmentStart,\n  onAssessmentProgress,\n  onAssessmentCompleted,\n};\n","// src/pages/CEO_Dashboard/CEODashboardComponents/Assessments.js\nimport React, { useEffect, useMemo, useRef, useState, useCallback } from \"react\";\nimport { useOutletContext } from \"react-router-dom\";\nimport Assessment from \"../../../Assessment\";\nimport { FaHistory, FaTrash, FaPlay, FaEye, FaTimes, FaCheckCircle, FaLightbulb, FaBuilding } from \"react-icons/fa\";\nimport { getSystemsForUI, normalizeSystemKey } from \"../constants/systems\";\nimport * as events from \"../lib/events\";\nimport * as svc from \"../services/serviceSelector\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { systems as assessmentSystems } from \"../../../data/systems\"; // Import actual assessment systems\n\n// NEW: orgHealth service (minimal ingest + persistence + event)\nimport * as orgHealth from \"../services/orgHealth\";\n\n/* ---------- constants: the 6 systems (canonical) ---------- */\nconst SYSTEMS = getSystemsForUI();\n\n// Return the ACTUAL full assessment systems from src/data/systems.js\n// This ensures real-time tracking counts match the actual questions users answer\nfunction createAssessmentSystems() {\n  // Return the exact same systems that Assessment.js uses\n  // NO simplification - this keeps question counts synchronized\n  return assessmentSystems;\n}\n\nconst STORAGE_KEY = \"conseqx_assessments_v1\";\nconst ANSWERS_STORAGE_KEY = \"conseqx_assessment_answers_v1\";\nconst PROGRESS_STORAGE_KEY = \"conseqx_assessment_progress_v1\";\n// Remove ad-hoc ML hooks here; real analysis is handled via services layer when needed\n\n/* ---------- storage helpers ---------- */\nfunction readAll() {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    return raw ? JSON.parse(raw) : {};\n  } catch {\n    return {};\n  }\n}\nfunction writeAll(obj) {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));\n  } catch {}\n}\nfunction addAssessmentForOrg(orgId, result, max = 200) {\n  if (!orgId) orgId = \"anon\";\n  const all = readAll();\n  const arr = all[orgId] || [];\n  const next = [{ ...result, timestamp: result.timestamp || Date.now() }, ...arr.filter((x) => x.id !== result.id)];\n  all[orgId] = next.slice(0, max);\n  writeAll(all);\n  return all[orgId];\n}\nfunction removeAssessmentForOrg(orgId, id) {\n  const all = readAll();\n  const arr = all[orgId] || [];\n  const next = arr.filter((x) => x.id !== id);\n  all[orgId] = next;\n  writeAll(all);\n  return next;\n}\nfunction summarizeSystems(arr = []) {\n  const bySys = {};\n  arr.forEach((r) => {\n    if (!r.systemId) return;\n    const k = normalizeSystemKey(r.systemId);\n    if (!bySys[k] || (bySys[k].timestamp || 0) < (r.timestamp || 0)) {\n      bySys[k] = { ...r, systemId: k };\n    }\n  });\n  return Object.keys(bySys).map((k) => ({ systemId: k, score: bySys[k].score || 0, result: bySys[k] }));\n}\n\n// Helper functions for persistent assessment state\nfunction readAssessmentAnswers(orgId) {\n  try {\n    const raw = localStorage.getItem(ANSWERS_STORAGE_KEY);\n    const data = raw ? JSON.parse(raw) : {};\n    return data[orgId] || {};\n  } catch {\n    return {};\n  }\n}\n\nfunction writeAssessmentAnswers(orgId, answers) {\n  try {\n    const raw = localStorage.getItem(ANSWERS_STORAGE_KEY);\n    const data = raw ? JSON.parse(raw) : {};\n    data[orgId] = answers;\n    localStorage.setItem(ANSWERS_STORAGE_KEY, JSON.stringify(data));\n  } catch {}\n}\n\nfunction readAssessmentProgress(orgId) {\n  try {\n    const raw = localStorage.getItem(PROGRESS_STORAGE_KEY);\n    const data = raw ? JSON.parse(raw) : {};\n    return data[orgId] || {};\n  } catch {\n    return {};\n  }\n}\n\nfunction writeAssessmentProgress(orgId, progress) {\n  try {\n    const raw = localStorage.getItem(PROGRESS_STORAGE_KEY);\n    const data = raw ? JSON.parse(raw) : {};\n    data[orgId] = progress;\n    localStorage.setItem(PROGRESS_STORAGE_KEY, JSON.stringify(data));\n  } catch {}\n}\n\n// Calculate answered count for a system based on the answer structure from Assessment.js\n// Assessment.js stores answers as: answers[subAssessmentId][questionId]\n// NOT as: answers[systemId][questionId]\nfunction calculateAnsweredCount(allAnswers, systemId) {\n  if (!allAnswers) return 0;\n  \n  // Count across all sub-assessments for this system\n  let totalAnswered = 0;\n  \n  // Find the system definition to get all its sub-assessments\n  const system = assessmentSystems.find(s => s.id === systemId);\n  if (!system || !system.subAssessments) return 0;\n  \n  // Count answered questions in each sub-assessment\n  // The answers are stored with subAssessment.id as the key, NOT systemId\n  system.subAssessments.forEach(subAssessment => {\n    const subAnswers = allAnswers[subAssessment.id] || {};\n    const answered = Object.keys(subAnswers).filter(key => {\n      const answer = subAnswers[key];\n      return answer !== null && answer !== undefined && answer !== '';\n    }).length;\n    totalAnswered += answered;\n  });\n  \n  return totalAnswered;\n}\n\n/* ---------- small UI primitives ---------- */\nfunction ProgressBar({ pct = 0, darkMode = false }) {\n  const containerBg = darkMode ? \"bg-gray-800\" : \"bg-gray-200\";\n  const fillClass = pct === 100 ? \"bg-green-500\" : \"bg-yellow-500\";\n  return (\n    <div className={`w-full h-2 rounded-full ${containerBg} overflow-hidden`}>\n      <div style={{ width: `${pct}%` }} className={`h-full ${fillClass}`} />\n    </div>\n  );\n}\n\nfunction SystemRow({ s, state, onStart, onView, onRemove, darkMode = false }) {\n  // state = { status: \"not-started\"|\"in-progress\"|\"completed\", progress, latestResult, answeredCount }\n  const hasAnswers = (state.answeredCount || 0) > 0;\n  const muted = !hasAnswers; // Only mute if no answers at all\n  const score = state.latestResult?.score ?? null;\n  const isAssessmentCompleted = state.status === \"completed\" && state.latestResult;\n  const hasRunCompleted = state.status === \"completed\" && score !== null;\n\n  const rowBgHover = darkMode ? \"hover:bg-gray-800\" : \"hover:bg-gray-50\";\n  const titleColor = darkMode ? \"text-gray-100\" : \"text-gray-900\";\n  const metaColor = darkMode ? \"text-gray-400\" : \"text-gray-500\";\n\n  // Run button logic: Lock (no answers) → Run (has answers, not running) → Running (in progress)\n  const isRunning = state.status === \"in-progress\" && state.progress < 100;\n  const runDisabled = isRunning || !hasAnswers;\n  const runBtnBase = runDisabled\n    ? `${darkMode ? \"bg-gray-800 text-gray-400 cursor-not-allowed\" : \"bg-gray-200 text-gray-500 cursor-not-allowed\"}`\n    : `${darkMode ? \"bg-blue-800 text-blue-200 hover:bg-blue-700\" : \"bg-blue-600 text-white hover:bg-blue-700\"}`;\n\n  // View button logic: Only enabled after run is completed with results\n  const viewDisabled = !hasRunCompleted;\n  const viewBtnBase = viewDisabled\n    ? `${darkMode ? \"bg-gray-900/20 text-gray-500 cursor-not-allowed\" : \"bg-gray-50 text-gray-400 cursor-not-allowed\"}`\n    : `${darkMode ? \"bg-green-800 text-green-200 hover:bg-green-700\" : \"bg-green-600 text-white hover:bg-green-700\"}`;\n\n  // Progress bar logic: show during analysis OR while answering questions\n  let progressPct = 0;\n  if (state.status === \"in-progress\") {\n    progressPct = state.progress;\n  } else if (hasAnswers && !isAssessmentCompleted) {\n    // Calculate percent answered\n    const system = assessmentSystems.find(sys => sys.id === s.id);\n    const totalQuestions = system ? system.subAssessments.reduce((sum, sub) => sum + sub.questions.length, 0) : 0;\n    progressPct = totalQuestions > 0 ? Math.round((state.answeredCount / totalQuestions) * 100) : 0;\n  }\n\n  return (\n    <div className={`flex items-center justify-between gap-2 p-2 rounded-md ${muted ? \"opacity-60\" : \"\"} ${rowBgHover} transition-all duration-200`}>\n      <div className=\"flex items-start gap-3 min-w-0\">\n        <div className=\"w-10 h-10 rounded-md bg-gradient-to-br from-indigo-600 to-blue-500 flex items-center justify-center text-white font-semibold\">\n          {s.icon}\n        </div>\n        <div className=\"min-w-0\">\n          <div className=\"flex items-center gap-2\">\n            <div className={`font-medium truncate ${titleColor}`}>{s.title}</div>\n            {state.status === \"completed\" && (\n              <div className={`text-xs px-2 py-0.5 rounded-full ${darkMode ? \"bg-green-900/30 text-green-300\" : \"bg-green-100 text-green-700\"}`}>\n                {score}%\n              </div>\n            )}\n            {state.status === \"in-progress\" && (\n              <div className={`text-xs px-2 py-0.5 rounded-full ${darkMode ? \"bg-yellow-900/20 text-yellow-300\" : \"bg-yellow-100 text-yellow-700\"}`}>\n                In progress\n              </div>\n            )}\n          </div>\n\n          <div className={`text-xs ${metaColor} mt-1`}>\n            {!hasAnswers && \"Complete assessment questions first\"}\n            {hasAnswers && (state.status === \"not-started\" || state.status === \"ready-to-run\") && \"Ready to run analysis\"}\n            {hasAnswers && state.status === \"in-progress\" && state.progress < 100 && `Analyzing... ${state.progress}%`}\n            {hasAnswers && state.status === \"in-progress\" && state.progress >= 100 && \"Analysis complete\"}\n            {isAssessmentCompleted && `Analysis completed ${new Date(state.latestResult.timestamp).toLocaleString()}`}\n            {hasAnswers && !isAssessmentCompleted && state.status !== \"in-progress\" && `${state.answeredCount} questions answered`}\n          </div>\n\n          {(progressPct > 0 && !isAssessmentCompleted) && (\n            <div className=\"mt-2\">\n              <ProgressBar pct={progressPct} darkMode={darkMode} />\n            </div>\n          )}\n          {state.status === \"in-progress\" && (\n            <div className=\"mt-2\">\n              <ProgressBar pct={state.progress} darkMode={darkMode} />\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-1\">\n        <button\n          onClick={() => onStart(s.id)}\n          disabled={runDisabled}\n          title={!hasAnswers ? \"Complete assessment questions first to unlock analysis\" : isRunning ? \"Analysis in progress...\" : \"Run AI analysis on assessment data\"}\n          className={`px-2 py-1.5 rounded-md border text-xs font-medium transition-all duration-200 ${runBtnBase}`}\n        >\n          <FaPlay className=\"inline-block mr-1\" size={10} />\n          {isRunning ? \"Analyzing...\" : !hasAnswers ? \"🔒 Locked\" : \"▶ Run\"}\n        </button>\n\n        <button\n          onClick={() => onView(s.id)}\n          disabled={viewDisabled}\n          title={viewDisabled ? \"Complete assessment to view results\" : \"View detailed results\"}\n          className={`px-2 py-1.5 rounded-md border text-xs transition-all duration-200 ${viewBtnBase}`}\n        >\n          <FaEye size={10} />\n        </button>\n\n        {state.latestResult && (\n          <button\n            onClick={() => onRemove(state.latestResult.id)}\n            className={`px-2 py-1.5 rounded-md text-xs transition-all duration-200 ${darkMode ? \"text-gray-400 hover:text-gray-200 hover:bg-gray-800\" : \"text-gray-500 hover:text-gray-700 hover:bg-gray-100\"}`}\n            title=\"Remove assessment\"\n          >\n            <FaTrash size={10} />\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/* ---------- main component ---------- */\nexport default function CEOAssessments() {\n  const { darkMode, org = null, user = null } = useOutletContext();\n  const orgId = org?.id || \"anon\";\n\n  // Broadcast parent theme changes as an event so nested components can optionally subscribe\n  useEffect(() => {\n    try {\n      window.dispatchEvent(new CustomEvent(\"conseqx:theme:changed\", { detail: { darkMode } }));\n    } catch {}\n  }, [darkMode]);\n\n  // recent are persisted assessment records for this org (chronological newest first)\n  const [recent, setRecent] = useState(() => {\n    try {\n      const all = readAll();\n      return all[orgId] || [];\n    } catch {\n      return [];\n    }\n  });\n\n  // systemStates maps systemId -> { status, progress, latestResult, answeredCount }\n  const [systemStates, setSystemStates] = useState(() => {\n    // derive initial state from recent items and persistent answers\n    const persistentAnswers = readAssessmentAnswers(orgId);\n    const init = {};\n    SYSTEMS.forEach((s) => {\n      const answeredCount = calculateAnsweredCount(persistentAnswers, s.id);\n      init[s.id] = { \n        status: \"not-started\", \n        progress: 0, \n        latestResult: null, \n        answeredCount \n      };\n    });\n    const byLatest = summarizeSystems(recent);\n    byLatest.forEach((b) => {\n      const answeredCount = calculateAnsweredCount(persistentAnswers, b.systemId);\n      if (!init[b.systemId]) {\n        init[b.systemId] = { \n          status: \"completed\", \n          progress: 100, \n          latestResult: b.result, \n          answeredCount \n        };\n      } else {\n        init[b.systemId] = { \n          status: \"completed\", \n          progress: 100, \n          latestResult: b.result, \n          answeredCount \n        };\n      }\n    });\n    return init;\n  });\n\n  // Real-time assessment progress tracking with persistent storage\n  // Note: Assessment.js manages the actual answer state internally\n  const [assessmentAnswers, setAssessmentAnswers] = useState({});\n  const [currentAssessmentSystem, setCurrentAssessmentSystem] = useState(null);\n  const [showDetailModal, setShowDetailModal] = useState(false);\n  const [selectedSystemDetails, setSelectedSystemDetails] = useState(null);\n  const [realTimeProgress, setRealTimeProgress] = useState(() => readAssessmentProgress(orgId));\n\n  // Close handler: hide modal then clear selected details after exit animation to avoid content flash\n  const handleClose = useCallback(() => {\n    setShowDetailModal(false);\n    // keep details for the duration of the exit animation so content doesn't disappear mid-animation\n    setTimeout(() => setSelectedSystemDetails(null), 320);\n  }, []);\n  \n  // Ref to track Assessment component's internal answer state (live)\n  const assessmentAnswersRef = useRef({});\n  \n  // Helper to get current answers (prefer live state from ref, fallback to state)\n  const getCurrentAnswers = () => {\n    return Object.keys(assessmentAnswersRef.current).length > 0 \n      ? assessmentAnswersRef.current \n      : assessmentAnswers;\n  };\n\n  // Broadcast update helper (persist + set state + broadcast event)\n  function persistAndBroadcast(newList) {\n    const all = readAll();\n    all[orgId] = newList;\n    writeAll(all);\n    setRecent(newList);\n\n    // update systemStates including answeredCount using LIVE answers\n    const byLatest = summarizeSystems(newList);\n    const currentAnswers = getCurrentAnswers(); // Use live answers from Assessment component\n    setSystemStates((prev) => {\n      const next = { ...prev };\n      SYSTEMS.forEach((s) => {\n        const answeredCount = calculateAnsweredCount(currentAnswers, s.id);\n        next[s.id] = next[s.id] || { \n          status: \"not-started\", \n          progress: 0, \n          latestResult: null, \n          answeredCount \n        };\n        // Update answeredCount even if already exists\n        next[s.id].answeredCount = answeredCount;\n      });\n      byLatest.forEach((b) => {\n        const answeredCount = calculateAnsweredCount(currentAnswers, b.systemId);\n        next[b.systemId] = { \n          status: \"completed\", \n          progress: 100, \n          latestResult: b.result, \n          answeredCount \n        };\n      });\n      return next;\n    });\n\n    // emit update event\n    try {\n      window.dispatchEvent(new CustomEvent(\"conseqx:assessments:updated\", { detail: { orgId, list: newList } }));\n    } catch {}\n    // BroadcastChannel for cross-tab (optional)\n    try {\n      if (\"BroadcastChannel\" in window) {\n        const bc = new BroadcastChannel(\"conseqx_assessments\");\n        bc.postMessage({ type: \"assessments:update\", orgId, payload: newList });\n        bc.close();\n      }\n    } catch {}\n  }\n\n  // handle completion event (from Assessment/System pages)\n  function handleAssessmentComplete(result = {}) {\n    const normalized = {\n      id: result.id || `A-${Date.now().toString(36)}`,\n      systemId: result.systemId || result.system || \"general\",\n      title: result.title || result.name || (result.systemId || \"Assessment\"),\n      score: typeof result.score === \"number\" ? result.score : result.score ? Number(result.score) : null,\n      owner: result.owner || (user && user.name) || \"Unknown\",\n      meta: result.meta || {},\n      timestamp: result.timestamp || Date.now(),\n      orgId,\n      notes: result.notes || \"\",\n    };\n\n    const newList = addAssessmentForOrg(orgId, normalized, 200);\n    persistAndBroadcast(newList);\n\n    // NEW: feed normalized assessment into the OrgHealth service\n    try {\n      orgHealth.ingestAssessment(normalized);\n    } catch (e) {\n      // non-fatal\n      console.error(\"Error ingesting assessment into orgHealth service\", e);\n    }\n  }\n\n  // handle incoming events\n  useEffect(() => {\n    function onCompleted(e) {\n      const result = e?.detail;\n      if (!result || (result.orgId && result.orgId !== orgId)) return;\n      handleAssessmentComplete(result);\n    }\n    function onProgress(e) {\n      const { systemId, progress } = e?.detail || {};\n      if (!systemId) return;\n      setSystemStates((prev) => {\n        const cur = prev[systemId] || { status: \"not-started\", progress: 0, latestResult: null };\n        const nextState = {\n          ...prev,\n          [systemId]: {\n            ...cur,\n            status: progress >= 100 ? \"completed\" : \"in-progress\",\n            progress: Math.max(0, Math.min(100, progress)),\n          },\n        };\n        // if completed and we have result in event, call handleAssessmentComplete (if detail includes result)\n        if (progress >= 100 && e.detail?.result) {\n          handleAssessmentComplete(e.detail.result);\n        }\n        return nextState;\n      });\n    }\n\n    function onAssessmentStart(e) {\n      const { systemId } = e?.detail || {};\n      if (!systemId) return;\n      setCurrentAssessmentSystem(systemId);\n      // Do not set analysis status to in-progress when user opens the assessment.\n      // \"in-progress\" should only reflect the AI analysis run, not question answering.\n      // We'll keep the current status here.\n    }\n\n    function onQuestionAnswered(e) {\n      const { systemId, questionId, answer, totalQuestions, answeredCount } = e?.detail || {};\n      if (!systemId) return;\n      \n      // Calculate real-time progress based on actual answered count from Assessment.js\n      const realAnsweredCount = answeredCount || 0;\n      const progress = totalQuestions > 0 ? Math.round((realAnsweredCount / totalQuestions) * 100) : 0;\n      \n      // Update real-time progress tracking\n      setRealTimeProgress((prev) => {\n        const updated = {\n          ...prev,\n          [systemId]: progress,\n        };\n        // Persist progress\n        writeAssessmentProgress(orgId, updated);\n        return updated;\n      });\n      \n      // Update system state with real progress and answeredCount from the event\n      setSystemStates((prev) => ({\n        ...prev,\n        [systemId]: {\n          ...(prev[systemId] || {}),\n          // While answering questions, status should indicate readiness, not analysis state.\n          status: realAnsweredCount > 0 ? \"ready-to-run\" : \"not-started\",\n          // Keep analysis progress separate; answering questions doesn't change analysis progress.\n          progress: prev[systemId]?.progress || 0,\n          answeredCount: realAnsweredCount,\n        },\n      }));\n      \n      // Emit progress event for other components\n      events.emitAssessmentProgress({ orgId, systemId, progress, answeredCount: realAnsweredCount });\n    }\n\n    window.addEventListener(\"conseqx:assessment:completed\", onCompleted);\n    window.addEventListener(\"conseqx:assessment:progress\", onProgress);\n    window.addEventListener(\"conseqx:assessment:start\", onAssessmentStart);\n    window.addEventListener(\"conseqx:assessment:question-answered\", onQuestionAnswered);\n    \n    return () => {\n      window.removeEventListener(\"conseqx:assessment:completed\", onCompleted);\n      window.removeEventListener(\"conseqx:assessment:progress\", onProgress);\n      window.removeEventListener(\"conseqx:assessment:start\", onAssessmentStart);\n      window.removeEventListener(\"conseqx:assessment:question-answered\", onQuestionAnswered);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [orgId]);\n\n  // also listen for BroadcastChannel updates (cross-tab)\n  useEffect(() => {\n    if (!(\"BroadcastChannel\" in window)) return;\n    const bc = new BroadcastChannel(\"conseqx_assessments\");\n    const handler = (ev) => {\n      try {\n        const { type, orgId: msgOrg, payload } = ev.data || {};\n        if (type === \"assessments:update\" && msgOrg === orgId) {\n          setRecent(payload || []);\n          // update systemStates derived including answeredCount using LIVE answers\n          const byLatest = summarizeSystems(payload || []);\n          const currentAnswers = getCurrentAnswers(); // Use live answers\n          setSystemStates((prev) => {\n            const next = { ...prev };\n            SYSTEMS.forEach((s) => {\n              const answeredCount = calculateAnsweredCount(currentAnswers, s.id);\n              next[s.id] = next[s.id] || { \n                status: \"not-started\", \n                progress: 0, \n                latestResult: null, \n                answeredCount \n              };\n              next[s.id].answeredCount = answeredCount;\n            });\n            byLatest.forEach((b) => {\n              const answeredCount = calculateAnsweredCount(currentAnswers, b.systemId);\n              next[b.systemId] = { \n                status: \"completed\", \n                progress: 100, \n                latestResult: b.result, \n                answeredCount \n              };\n            });\n            return next;\n          });\n        }\n      } catch (e) {}\n    };\n    bc.addEventListener(\"message\", handler);\n    return () => bc.close();\n  }, [orgId]);\n\n  // Sync with localStorage changes for real-time updates\n  useEffect(() => {\n    const syncFromStorage = () => {\n      const persistentProgress = readAssessmentProgress(orgId);\n      setRealTimeProgress(persistentProgress);\n      \n      // Update system states with current answered counts from LIVE state\n      const currentAnswers = getCurrentAnswers(); // Use live answers from Assessment\n      setSystemStates((prev) => {\n        const next = { ...prev };\n        SYSTEMS.forEach((s) => {\n          const answeredCount = calculateAnsweredCount(currentAnswers, s.id);\n          if (next[s.id]) {\n            next[s.id] = {\n              ...next[s.id],\n              answeredCount,\n              // Update status based on answers and current state\n              status: next[s.id].latestResult ? \"completed\" : \n                      answeredCount > 0 ? \"ready-to-run\" : \"not-started\"\n            };\n          }\n        });\n        return next;\n      });\n    };\n\n    // Listen for storage events (cross-tab sync)\n    const handleStorageChange = (e) => {\n      if (e.key === ANSWERS_STORAGE_KEY || e.key === PROGRESS_STORAGE_KEY) {\n        syncFromStorage();\n      }\n    };\n\n    window.addEventListener('storage', handleStorageChange);\n    \n    // Periodic sync to catch any missed updates\n    const syncInterval = setInterval(syncFromStorage, 1000);\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange);\n      clearInterval(syncInterval);\n    };\n  }, [orgId]);\n\n  // Prevent accidental navigation during active assessment\n  useEffect(() => {\n    const hasActiveAssessment = Object.values(systemStates).some(state => \n      (state.answeredCount || 0) > 0 && !state.latestResult\n    );\n\n    const handleBeforeUnload = (e) => {\n      if (hasActiveAssessment) {\n        e.preventDefault();\n        e.returnValue = 'You have unsaved assessment progress. Are you sure you want to leave?';\n        return 'You have unsaved assessment progress. Are you sure you want to leave?';\n      }\n    };\n\n    if (hasActiveAssessment) {\n      window.addEventListener('beforeunload', handleBeforeUnload);\n    }\n\n    return () => {\n      window.removeEventListener('beforeunload', handleBeforeUnload);\n    };\n  }, [systemStates]);\n\n  /* ---------- Actions invoked by the panel ---------- */\n\n  // onStart: if real system page is active, you should route there; else we simulate a run here.\n  function onStart(systemId) {\n    const cur = systemStates[systemId];\n    // if in-progress and <100 do nothing\n    if (cur && cur.status === \"in-progress\" && cur.progress < 100) return;\n\n    // if already completed, allow new run; otherwise start run\n    // Ideally you should navigate to the system-specific assessment UI here:\n    // navigate(`/system/${systemId}`) or open slide-over; for now emit an event\n    events.emitAssessmentStart({ systemId, orgId });\n\n    // if no other component will handle start, we simulate progress here and complete a deterministic result\n    simulateRunIfNoHandler(systemId);\n  }\n\n  // onView: show report for latestResult - can open slide-over or navigate to report page\n  function onView(systemId) {\n    const state = systemStates[systemId];\n    if (!state || !state.latestResult) return;\n    \n    // Find the system details\n    const systemDetails = SYSTEMS.find(s => s.id === systemId);\n    if (systemDetails) {\n      // Enrich modal with per-sub-assessment answers and progress\n      const allAnswers = getCurrentAnswers();\n      const sysDef = assessmentSystems.find(s => s.id === systemId);\n      const perSubAnswers = {};\n      sysDef?.subAssessments?.forEach(sub => {\n        if (allAnswers[sub.id]) perSubAnswers[sub.id] = allAnswers[sub.id];\n      });\n      // Calculate progress per sub-assessment\n      const subProgress = sysDef?.subAssessments?.map(sub => {\n        const total = sub.questions.length;\n        const answered = perSubAnswers[sub.id] ? Object.keys(perSubAnswers[sub.id]).filter(k => {\n          const a = perSubAnswers[sub.id][k];\n          return a !== null && a !== undefined && a !== '';\n        }).length : 0;\n        return { id: sub.id, title: sub.title, answered, total };\n      }) || [];\n\n      const details = {\n        ...systemDetails,\n        result: state.latestResult,\n        answers: perSubAnswers,\n        subProgress,\n      };\n      // don't reopen if already showing same result (prevents flicker)\n      if (showDetailModal && selectedSystemDetails && selectedSystemDetails.result?.id === state.latestResult.id) return;\n      setSelectedSystemDetails(details);\n      // open synchronously; details will be cleared after exit animation by handleClose\n      setShowDetailModal(true);\n    }\n    \n    // Also dispatch event for other components\n    try {\n      window.dispatchEvent(new CustomEvent(\"conseqx:assessment:view\", { detail: { result: state.latestResult } }));\n    } catch {}\n  }\n\n  function onRemove(id) {\n    const next = removeAssessmentForOrg(orgId, id);\n    persistAndBroadcast(next);\n  }\n\n  // Simulation: if nobody handles start event within a short time, run an internal simulated run\n  function simulateRunIfNoHandler(systemId) {\n    // mark in-progress\n    setSystemStates((prev) => ({ ...prev, [systemId]: { ...(prev[systemId] || {}), status: \"in-progress\", progress: 1 } }));\n\n    // simulate progress increments until 100\n    let pct = 1;\n    const ticker = setInterval(() => {\n      pct = Math.min(100, pct + Math.round(5 + Math.random() * 12));\n      // dispatch progress event (so all listeners get updated)\n      events.emitAssessmentProgress({ orgId, systemId, progress: pct });\n      if (pct >= 100) {\n        clearInterval(ticker);\n        // produce a deterministic result via service selector (mock or API)\n        (async () => {\n          const result = await svc.runAssessment(orgId, systemId);\n          events.emitAssessmentCompleted(result);\n        })();\n      }\n    }, 800);\n  }\n\n  // derived KPIs\n  const kpis = useMemo(() => {\n    const count = recent.length;\n    const avgScore = count ? Math.round(recent.reduce((s, r) => s + (Number(r.score) || 0), 0) / count) : null;\n    const lastRun = recent[0]?.timestamp || null;\n    return { count, avgScore, lastRun };\n  }, [recent]);\n\n  // Detailed Assessment Modal Component\n  // Always-mounted modal that shows/hides its content based on `isOpen` to avoid mount/unmount flicker\n  const DetailedAssessmentModal = ({ isOpen }) => {\n    if (!selectedSystemDetails && !isOpen) return null;\n\n  const { title, result, icon, answers, subProgress } = selectedSystemDetails || {};\n    const score = result?.score || 0;\n    const timestamp = result?.timestamp;\n\n    // Mock AI recommendations and case studies for demonstration\n    const aiRecommendations = [\n      \"Implement structured feedback loops to improve communication\",\n      \"Establish clear performance metrics and tracking systems\",\n      \"Develop cross-functional collaboration protocols\",\n      \"Create standardized training programs for consistency\"\n    ];\n\n    const caseStudy = {\n      company: \"Dangote Group (Nigeria)\",\n      challenge: `Similar challenges in ${title.toLowerCase()} across multiple business units`,\n      solution: \"Implemented centralized governance framework with decentralized execution\",\n      result: \"35% improvement in operational efficiency within 18 months\",\n      keyLessons: [\n        \"Standardized processes while maintaining local flexibility\",\n        \"Invested in technology infrastructure for real-time monitoring\",\n        \"Created cross-functional teams to break down silos\"\n      ]\n    };\n\n    return (\n      <AnimatePresence>\n        {isOpen && selectedSystemDetails && (\n          <motion.div\n            key={selectedSystemDetails.result?.id || 'detail-modal'}\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\n            onClick={handleClose}\n          >\n            <motion.div\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n              className={`max-w-4xl w-full max-h-[90vh] overflow-y-auto rounded-2xl ${darkMode ? \"bg-gray-900 border-gray-700\" : \"bg-white border-gray-200\"} border shadow-2xl`}\n              onClick={(e) => e.stopPropagation()}\n            >\n            {/* Header */}\n            <div className={`sticky top-0 ${darkMode ? \"bg-gray-900 border-gray-700\" : \"bg-white border-gray-200\"} border-b px-6 py-4 flex items-center justify-between`}>\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-12 h-12 rounded-lg bg-gradient-to-br from-indigo-600 to-blue-500 flex items-center justify-center text-white text-xl font-bold\">\n                  {icon}\n                </div>\n                <div>\n                  <h2 className={`text-xl font-bold ${darkMode ? \"text-gray-100\" : \"text-gray-900\"}`}>\n                    {title} Assessment Results\n                  </h2>\n                  <p className={`text-sm ${darkMode ? \"text-gray-400\" : \"text-gray-500\"}`}>\n                    Completed {timestamp ? new Date(timestamp).toLocaleString() : 'Recently'}\n                  </p>\n                </div>\n              </div>\n              <button\n                onClick={handleClose}\n                className={`p-2 rounded-lg ${darkMode ? \"hover:bg-gray-800 text-gray-400\" : \"hover:bg-gray-100 text-gray-500\"}`}\n              >\n                <FaTimes size={20} />\n              </button>\n            </div>\n\n            <div className=\"p-6 space-y-6\">\n              {/* Score Overview */}\n              <div className={`rounded-xl p-4 ${darkMode ? \"bg-gray-800\" : \"bg-gray-50\"}`}>\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h3 className={`font-semibold ${darkMode ? \"text-gray-100\" : \"text-gray-900\"}`}>Overall Score</h3>\n                  <div className={`text-2xl font-bold ${score >= 80 ? \"text-green-500\" : score >= 60 ? \"text-yellow-500\" : \"text-red-500\"}`}>\n                    {score}%\n                  </div>\n                </div>\n                <div className={`w-full h-3 rounded-full ${darkMode ? \"bg-gray-700\" : \"bg-gray-200\"}`}>\n                  <div\n                    className={`h-full rounded-full transition-all duration-500 ${\n                      score >= 80 ? \"bg-green-500\" : score >= 60 ? \"bg-yellow-500\" : \"bg-red-500\"\n                    }`}\n                    style={{ width: `${score}%` }}\n                  />\n                </div>\n              </div>\n\n              {/* Sub-assessments with progress and answers */}\n              <div>\n                <h3 className={`text-lg font-semibold mb-4 ${darkMode ? \"text-gray-100\" : \"text-gray-900\"}`}>\n                  Assessment Breakdown\n                </h3>\n                <div className=\"space-y-3\">\n                  {subProgress.map((sub, index) => (\n                    <div key={sub.id} className={`p-4 rounded-lg border ${darkMode ? \"bg-gray-800 border-gray-700\" : \"bg-gray-50 border-gray-200\"}`}>\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <h4 className={`font-medium ${darkMode ? \"text-gray-200\" : \"text-gray-800\"}`}>{sub.title}</h4>\n                        <div className=\"flex items-center gap-2\">\n                          <FaCheckCircle className=\"text-green-500\" size={16} />\n                          <span className={`text-sm ${darkMode ? \"text-gray-400\" : \"text-gray-600\"}`}>\n                            {sub.answered} / {sub.total} answered\n                          </span>\n                        </div>\n                      </div>\n                      <div className=\"w-full mb-2\">\n                        <ProgressBar pct={sub.total > 0 ? Math.round((sub.answered / sub.total) * 100) : 0} darkMode={darkMode} />\n                      </div>\n                      <p className={`text-sm ${darkMode ? \"text-gray-400\" : \"text-gray-600\"}`}>Questions:</p>\n                      <ul className=\"list-disc list-inside ml-4\">\n                        {Object.entries(answers[sub.id] || {}).map(([qid, val]) => (\n                          <li key={qid} className={`text-xs ${darkMode ? \"text-gray-300\" : \"text-gray-700\"}`}>Q{qid}: <span className=\"font-semibold\">{val}</span></li>\n                        ))}\n                      </ul>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* AI Recommendations */}\n              <div>\n                <h3 className={`text-lg font-semibold mb-4 flex items-center gap-2 ${darkMode ? \"text-gray-100\" : \"text-gray-900\"}`}>\n                  <FaLightbulb className=\"text-yellow-500\" />\n                  AI Recommendations\n                </h3>\n                <div className=\"space-y-2\">\n                  {aiRecommendations.map((rec, index) => (\n                    <div key={index} className={`p-3 rounded-lg ${darkMode ? \"bg-blue-900/20 border-blue-500/30\" : \"bg-blue-50 border-blue-200\"} border`}>\n                      <p className={`text-sm ${darkMode ? \"text-blue-200\" : \"text-blue-800\"}`}>{rec}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* African Company Case Study */}\n              <div>\n                <h3 className={`text-lg font-semibold mb-4 flex items-center gap-2 ${darkMode ? \"text-gray-100\" : \"text-gray-900\"}`}>\n                  <FaBuilding className=\"text-green-500\" />\n                  African Success Story\n                </h3>\n                <div className={`rounded-xl p-4 border ${darkMode ? \"bg-green-900/20 border-green-500/30\" : \"bg-green-50 border-green-200\"}`}>\n                  <div className=\"space-y-3\">\n                    <div>\n                      <h4 className={`font-semibold ${darkMode ? \"text-green-200\" : \"text-green-800\"}`}>{caseStudy.company}</h4>\n                      <p className={`text-sm mt-1 ${darkMode ? \"text-green-300\" : \"text-green-700\"}`}>{caseStudy.challenge}</p>\n                    </div>\n                    \n                    <div>\n                      <h5 className={`font-medium ${darkMode ? \"text-green-200\" : \"text-green-800\"}`}>Solution:</h5>\n                      <p className={`text-sm ${darkMode ? \"text-green-300\" : \"text-green-700\"}`}>{caseStudy.solution}</p>\n                    </div>\n                    \n                    <div>\n                      <h5 className={`font-medium ${darkMode ? \"text-green-200\" : \"text-green-800\"}`}>Result:</h5>\n                      <p className={`text-sm ${darkMode ? \"text-green-300\" : \"text-green-700\"}`}>{caseStudy.result}</p>\n                    </div>\n                    \n                    <div>\n                      <h5 className={`font-medium ${darkMode ? \"text-green-200\" : \"text-green-800\"}`}>Key Lessons:</h5>\n                      <ul className=\"list-disc list-inside space-y-1 mt-1\">\n                        {caseStudy.keyLessons.map((lesson, index) => (\n                          <li key={index} className={`text-sm ${darkMode ? \"text-green-300\" : \"text-green-700\"}`}>{lesson}</li>\n                        ))}\n                      </ul>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </motion.div>\n        </motion.div>\n      )}\n      </AnimatePresence>\n    );\n  };\n\n  return (\n    <section>\n      <div className=\"flex items-start justify-between gap-4\">\n        <div>\n          <h2 className={`${darkMode ? \"text-gray-100\" : \"text-gray-900\"} text-lg font-semibold`}>Assessments</h2>\n          <p className={`mt-2 text-sm ${darkMode ? \"text-gray-300\" : \"text-gray-600\"}`}>\n            Run or view system assessments. Systems update in real-time as runs progress and complete.\n          </p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <div className={`${darkMode ? \"text-gray-200\" : \"text-sm text-gray-700\"}`}>\n            <div>\n              Recent runs: <span className=\"font-semibold\">{kpis.count}</span>\n            </div>\n            <div className={`${darkMode ? \"text-gray-400\" : \"text-xs text-gray-500\"}`}>Avg score: {kpis.avgScore !== null ? `${kpis.avgScore}%` : \"—\"}</div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4\">\n        <div className=\"lg:col-span-2\">\n          <div className={`rounded-xl p-3 border ${darkMode ? \"bg-gray-900 border-gray-700\" : \"bg-white border-gray-100\"} shadow-sm`}>\n            {/* Embedded Assessment component: it should call onComplete when it finishes */}\n            {/* Pass darkMode prop + key to force remount on theme change so internal theme state can't diverge */}\n            <Assessment\n              key={darkMode ? \"assessment-dark\" : \"assessment-light\"}\n              darkMode={darkMode}\n              onComplete={(res) => handleAssessmentComplete(res)}\n              onAnswersChange={(answers) => {\n                // Track the actual answer state from Assessment.js\n                assessmentAnswersRef.current = answers;\n                setAssessmentAnswers(answers);\n                \n                // Immediately update system states with new answered counts\n                setSystemStates((prev) => {\n                  const next = { ...prev };\n                  SYSTEMS.forEach((s) => {\n                    const answeredCount = calculateAnsweredCount(answers, s.id);\n                    if (next[s.id]) {\n                      next[s.id] = {\n                        ...next[s.id],\n                        answeredCount,\n                        // Update status based on current answers\n                        status: next[s.id].latestResult ? \"completed\" : \n                                answeredCount > 0 ? \"ready-to-run\" : \"not-started\"\n                      };\n                    } else {\n                      // Initialize if doesn't exist\n                      next[s.id] = {\n                        status: answeredCount > 0 ? \"ready-to-run\" : \"not-started\",\n                        progress: 0,\n                        latestResult: null,\n                        answeredCount\n                      };\n                    }\n                  });\n                  return next;\n                });\n              }}\n              onQuestionAnswered={(data) => {\n                // Emit real-time progress event with enhanced data\n                window.dispatchEvent(new CustomEvent(\"conseqx:assessment:question-answered\", { \n                  detail: {\n                    ...data,\n                    orgId,\n                    timestamp: Date.now()\n                  }\n                }));\n              }}\n              onSystemStart={(systemId) => {\n                // Emit system start event\n                window.dispatchEvent(new CustomEvent(\"conseqx:assessment:start\", { \n                  detail: { \n                    systemId, \n                    orgId,\n                    timestamp: Date.now()\n                  } \n                }));\n              }}\n              showClientInfo={false}\n              customSystems={createAssessmentSystems()}\n              ceoPartnerMode={true}\n              orgId={orgId}\n              // Pass current answers to maintain state\n              initialAnswers={assessmentAnswers}\n              // Enable real-time progress tracking\n              enableRealTimeTracking={true}\n            />\n          </div>\n        </div>\n\n        <aside className={`rounded-xl p-3 border ${darkMode ? \"bg-gray-900 border-gray-700\" : \"bg-white border-gray-100\"} shadow-sm`}>\n          <div className=\"flex items-center justify-between mb-3\">\n            <div className={`text-sm font-semibold ${darkMode ? \"text-gray-100\" : \"text-gray-900\"}`}>Systems</div>\n            <div className={`${darkMode ? \"text-xs text-gray-400\" : \"text-xs text-gray-500\"} flex items-center gap-2`}>\n              <FaHistory /> <span>{recent.length}</span>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            {SYSTEMS.map((s) => {\n              const currentState = systemStates[s.id] || { \n                status: \"not-started\", \n                progress: 0, \n                latestResult: null, \n                answeredCount: 0 \n              };\n              \n              return (\n                <SystemRow\n                  key={s.id}\n                  s={s}\n                  state={currentState}\n                  onStart={onStart}\n                  onView={onView}\n                  onRemove={onRemove}\n                  darkMode={darkMode}\n                />\n              );\n            })}\n          </div>\n\n          <div className={`mt-3 border-t pt-2 ${darkMode ? \"text-xs text-gray-400 border-gray-800\" : \"text-xs text-gray-500 border-gray-200\"}`}>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <div className={`w-2 h-2 rounded-full ${darkMode ? \"bg-blue-500\" : \"bg-blue-600\"} animate-pulse`}></div>\n                <span>Real-time assessment tracking with X-Ultra intelligence</span>\n              </div>\n              <div className=\"flex items-center gap-1\">\n                {Object.values(systemStates).some(state => (state.answeredCount || 0) > 0) && (\n                  <span className={`px-2 py-0.5 rounded-full text-xs ${darkMode ? \"bg-green-900/30 text-green-300\" : \"bg-green-100 text-green-700\"}`}>\n                    Active\n                  </span>\n                )}\n              </div>\n            </div>\n          </div>\n        </aside>\n      </div>\n      \n  {/* Detailed Assessment Modal (mounted always, visibility controlled by isOpen) */}\n  <DetailedAssessmentModal isOpen={showDetailModal} />\n    </section>\n  );\n}\n","// src/pages/CEO_Dashboard/services/orgHealth/index.js\n// Minimal OrgHealth service: ingest assessment -> map to simple metrics -> compute score -> persist -> emit events\n\nimport { computeSystemScore } from \"./score\";\n\nconst ORG_HEALTH_KEY = \"conseqx_org_health_v1\";\n\n/**\n * Persist results per orgId (simple localStorage JSON).\n */\nfunction readAll() {\n  try {\n    const raw = localStorage.getItem(ORG_HEALTH_KEY);\n    return raw ? JSON.parse(raw) : {};\n  } catch {\n    return {};\n  }\n}\nfunction writeAll(obj) {\n  try {\n    localStorage.setItem(ORG_HEALTH_KEY, JSON.stringify(obj));\n  } catch {}\n}\n\n/**\n * Save a single computed system result\n */\nexport function saveResult(orgId, result) {\n  if (!orgId) orgId = \"anon\";\n  const all = readAll();\n  const arr = all[orgId] || [];\n  // Prepend newest\n  arr.unshift(result);\n  all[orgId] = arr.slice(0, 300); // keep a cap\n  writeAll(all);\n\n  try {\n    window.dispatchEvent(new CustomEvent(\"conseqx:orghealth:completed\", { detail: { orgId, result } }));\n  } catch {}\n}\n\n/**\n * Basic mapping: convert an assessment result into metrics for a given system.\n * This is intentionally simple and deterministic.\n *\n * result: normalized assessment object (see Assessments.js normalized variable)\n */\nexport function ingestAssessment(result = {}) {\n  try {\n    const orgId = result.orgId || \"anon\";\n    const systemId = result.systemId || result.system || \"general\";\n\n    // Build example metrics by looking into result.meta and score\n    // We expect Assessment meta to include helpful keys; otherwise derive from score\n    const meta = result.meta || {};\n\n    // Basic normalized metrics (0..1)\n    // - networkDensity: prefer explicit meta.networkDensity or derive from score\n    // - sentiment: prefer meta.sentiment (-1..1) -> map to 0..1\n    // - operational: prefer meta.operational (0..1)\n    const networkDensity = typeof meta.networkDensity === \"number\" ? Math.max(0, Math.min(1, meta.networkDensity)) : (Number(result.score) ? Math.min(1, result.score / 100) : 0.5);\n    const rawSent = typeof meta.sentiment === \"number\" ? meta.sentiment : null; // expected -1..1\n    const sentiment = rawSent !== null ? Math.max(0, Math.min(1, (rawSent + 1) / 2)) : Math.min(1, (Number(result.score) || 0) / 100);\n    const operational = typeof meta.operational === \"number\" ? Math.max(0, Math.min(1, meta.operational)) : Math.min(1, (Number(result.score) || 0) / 100);\n\n    // Choose weights depending on system\n    const defaultWeights = { networkDensity: 0.4, sentiment: 0.3, operational: 0.3 };\n    let weights = defaultWeights;\n\n    // Example per-system custom weights\n    const systemWeights = {\n      interdependency: { networkDensity: 0.6, sentiment: 0.2, operational: 0.2 },\n      investigation: { networkDensity: 0.2, sentiment: 0.2, operational: 0.6 },\n      inlignment: { networkDensity: 0.2, sentiment: 0.4, operational: 0.4 },\n      orchestration: { networkDensity: 0.3, sentiment: 0.2, operational: 0.5 },\n      illustration: { networkDensity: 0.2, sentiment: 0.5, operational: 0.3 },\n      interpretation: { networkDensity: 0.2, sentiment: 0.5, operational: 0.3 }\n    };\n    if (systemWeights[systemId]) weights = systemWeights[systemId];\n\n    const metrics = {\n      networkDensity,\n      sentiment,\n      operational\n    };\n\n    const score = computeSystemScore(metrics, weights);\n\n    const out = {\n      id: result.id || `oh-${Date.now().toString(36)}`,\n      orgId,\n      systemId,\n      score,\n      breakdown: metrics,\n      provenance: {\n        sourceAssessmentId: result.id,\n        algorithmVersion: \"orghealth-v1\",\n        createdAt: Date.now()\n      },\n      timestamp: Date.now(),\n      // keep original result for traceability\n      original: {\n        title: result.title,\n        owner: result.owner,\n        meta: result.meta || {}\n      }\n    };\n\n    // Persist result\n    saveResult(orgId, out);\n\n    // Build a small recommendation stub (consumer UI can enrich or run an LLM for richer text)\n    const recommendation = {\n      id: `rec-${Date.now().toString(36)}`,\n      title: `Investigate ${systemId} - ${score}%`,\n      summary: `System ${systemId} received a score of ${score}%. Key drivers: ${Object.entries(metrics).map(([k, v]) => `${k}=${Math.round(v * 100)}%`).join(\", \")}.`,\n      impact: score < 60 ? \"High — potential risk\" : score < 75 ? \"Medium\" : \"Low\",\n      severity: score < 60 ? \"warning\" : \"improvement\",\n      predictions: {\n        short: score < 60 ? \"Short term: Operational friction, delays.\" : \"Short term: Stable\",\n        mid: score < 60 ? \"Mid term: Reduced throughput if unresolved.\" : \"Mid term: Maintain improvements\",\n        long: \"Long term: Monitor trends\"\n      },\n      evidence: [\n        `Derived from assessment ${result.id}`,\n        ...(result.meta && result.meta.notes ? [result.meta.notes] : [])\n      ],\n      comparables: [],\n      recommendedMeeting: {\n        title: `Cross-functional sync: ${systemId}`,\n        urgency: score < 60 ? \"Urgent\" : \"High\",\n        attendees: [\"Head of Product\", \"Head of Engineering\", \"Ops Lead\"],\n        proposedDurationMin: 45,\n        agenda: [\"Review findings\", \"Assign owners\", \"Agree next steps\"]\n      },\n      source: `Assessment: ${systemId}`,\n      createdAt: Date.now()\n    };\n\n    // Emit recommendation event for UI to pick up\n    try {\n      window.dispatchEvent(new CustomEvent(\"conseqx:orghealth:recommendation\", { detail: { orgId, recommendations: [recommendation] } }));\n    } catch {}\n\n    return out;\n  } catch (e) {\n    // swallow errors (non-fatal) — real service should surface logs\n    console.error(\"orgHealth.ingestAssessment error\", e);\n    return null;\n  }\n}\n\n/**\n * Return persisted results for an org\n */\nexport function getResults(orgId) {\n  const all = readAll();\n  return all[orgId] || [];\n}\n","// src/pages/CEO_Dashboard/services/orgHealth/score.js\n// Small deterministic scoring util for organizational health systems.\n// Keep calculations simple and auditable.\n\nexport function computeSystemScore(metrics = {}, weights = {}) {\n  // metrics: { metricKey: valueBetween0And1, ... }\n  // weights: { metricKey: weight, ... }\n  const weightKeys = Object.keys(weights);\n  if (weightKeys.length === 0) {\n    // If no weights provided, average metrics\n    const vals = Object.values(metrics);\n    if (vals.length === 0) return 0;\n    const avg = vals.reduce((s, v) => s + (Number(v) || 0), 0) / vals.length;\n    return Math.round(avg * 100);\n  }\n\n  const sumWeights = weightKeys.reduce((s, k) => s + (Number(weights[k]) || 0), 0) || 1;\n  const raw = weightKeys.reduce((acc, k) => {\n    const v = Number(metrics[k]) || 0;\n    const w = Number(weights[k]) || 0;\n    return acc + v * w;\n  }, 0);\n  const normalized = raw / sumWeights;\n  return Math.round(Math.max(0, Math.min(1, normalized)) * 100);\n}\n"],"names":["EVENT_NAMES","start","progress","completed","view","emitAssessmentStart","_ref","orgId","systemId","window","dispatchEvent","CustomEvent","detail","_unused","emitAssessmentProgress","_ref2","result","_unused2","emitAssessmentCompleted","resultObject","_unused3","SYSTEMS","getSystemsForUI","STORAGE_KEY","ANSWERS_STORAGE_KEY","PROGRESS_STORAGE_KEY","readAll","raw","localStorage","getItem","JSON","parse","writeAll","obj","setItem","stringify","summarizeSystems","bySys","arguments","length","undefined","forEach","r","k","normalizeSystemKey","timestamp","_objectSpread","Object","keys","map","score","readAssessmentProgress","_unused5","calculateAnsweredCount","allAnswers","totalAnswered","system","assessmentSystems","find","s","id","subAssessments","subAssessment","subAnswers","answered","filter","key","answer","ProgressBar","pct","darkMode","containerBg","fillClass","_jsx","className","concat","children","style","width","SystemRow","_state$latestResult$s","_state$latestResult","state","onStart","onView","onRemove","hasAnswers","answeredCount","muted","latestResult","isAssessmentCompleted","status","hasRunCompleted","rowBgHover","titleColor","metaColor","isRunning","runDisabled","runBtnBase","viewDisabled","viewBtnBase","progressPct","sys","totalQuestions","reduce","sum","sub","questions","Math","round","_jsxs","icon","title","Date","toLocaleString","onClick","disabled","FaPlay","size","FaEye","FaTrash","CEOAssessments","org","user","useOutletContext","useEffect","_unused7","recent","setRecent","useState","_unused8","systemStates","setSystemStates","persistentAnswers","readAssessmentAnswers","init","b","assessmentAnswers","setAssessmentAnswers","currentAssessmentSystem","setCurrentAssessmentSystem","showDetailModal","setShowDetailModal","selectedSystemDetails","setSelectedSystemDetails","realTimeProgress","setRealTimeProgress","handleClose","useCallback","setTimeout","assessmentAnswersRef","useRef","getCurrentAnswers","current","persistAndBroadcast","newList","all","byLatest","currentAnswers","prev","next","list","_unused9","bc","BroadcastChannel","postMessage","type","payload","close","_unused0","handleAssessmentComplete","normalized","now","toString","name","Number","owner","meta","notes","max","arr","x","slice","addAssessmentForOrg","orgHealth","e","console","error","cur","events","ticker","setInterval","min","random","clearInterval","svc","simulateRunIfNoHandler","systemDetails","_sysDef$subAssessment","_sysDef$subAssessment2","_selectedSystemDetail","sysDef","perSubAnswers","subProgress","total","a","details","answers","_unused1","removeAssessmentForOrg","onCompleted","onProgress","_e$detail","nextState","onAssessmentStart","onQuestionAnswered","questionId","realAnsweredCount","updated","data","_unused6","writeAssessmentProgress","_prev$systemId","addEventListener","removeEventListener","ev","msgOrg","syncFromStorage","persistentProgress","handleStorageChange","syncInterval","hasActiveAssessment","values","some","handleBeforeUnload","preventDefault","returnValue","kpis","useMemo","_recent$","count","avgScore","lastRun","DetailedAssessmentModal","_ref3","_selectedSystemDetail2","isOpen","caseStudy","company","challenge","toLowerCase","solution","keyLessons","AnimatePresence","motion","div","initial","opacity","animate","exit","scale","stopPropagation","FaTimes","index","FaCheckCircle","entries","_ref4","qid","val","FaLightbulb","rec","FaBuilding","lesson","Assessment","onComplete","res","onAnswersChange","onSystemStart","showClientInfo","customSystems","ceoPartnerMode","initialAnswers","enableRealTimeTracking","FaHistory","currentState","ORG_HEALTH_KEY","saveResult","unshift","ingestAssessment","networkDensity","rawSent","sentiment","operational","weights","systemWeights","interdependency","investigation","inlignment","orchestration","illustration","interpretation","metrics","weightKeys","vals","avg","v","sumWeights","acc","computeSystemScore","out","breakdown","provenance","sourceAssessmentId","algorithmVersion","createdAt","original","recommendation","summary","join","impact","severity","predictions","short","mid","long","evidence","comparables","recommendedMeeting","urgency","attendees","proposedDurationMin","agenda","source","recommendations","_unused4","getResults"],"sourceRoot":""}